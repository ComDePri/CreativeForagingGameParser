(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     76653,       1804]
NotebookOptionsPosition[     71626,       1709]
NotebookOutlinePosition[     72483,       1735]
CellTagsIndexPosition[     72440,       1732]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["ParserLightUtils.m package", "Title",
 CellChangeTimes->{{3.8269419018262568`*^9, 3.8269419032644424`*^9}},
 TextAlignment->Center,ExpressionUUID->"d28b36c3-0018-4f61-a12b-27c9218b0216"],

Cell[CellGroupData[{

Cell["Begin the package", "Section",ExpressionUUID->"86fcb346-a88e-466f-8d41-c8860af1f69e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BeginPackage", "[", "\"\<ParserLightUtils`\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.826942668635238*^9, 3.826942670216714*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"35112834-79e8-49f1-a76a-dfe10e8c9f1d"],

Cell[BoxData["\<\"ParserLightUtils`\"\>"], "Output",
 CellChangeTimes->{
  3.8279415248049192`*^9, {3.8279416401465836`*^9, 3.8279416481663513`*^9}},
 CellLabel->"Out[28]=",ExpressionUUID->"a6bc6ff8-2a05-49e7-aea8-cfee39233abe"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Usage messages for the public functions", "Subsection",ExpressionUUID->"219ca509-2316-4f05-95b7-a14d7537bd79"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Parse", "::", "usage"}], " ", "=", " ", 
  "\"\<Parse[gameData] parses a single game a returns a 4-column summary of \
its data, used in any further analysis\>\""}]], "Input",
 CellChangeTimes->{{3.820866494668766*^9, 3.8208665229339952`*^9}, {
  3.8269405978448257`*^9, 3.826940600070467*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"af686d94-e4e4-43ac-8b55-76c8fb167801"],

Cell[BoxData["\<\"Parse[gameData] parses a single game a returns a 4-column \
summary of its data, used in any further analysis\"\>"], "Output",
 CellChangeTimes->{3.8279415248537602`*^9, 3.8279416403041916`*^9},
 CellLabel->"Out[2]=",ExpressionUUID->"b887b837-fc8c-4a0d-a329-8c647fcd0863"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"extractMeasures", "::", "usage"}], " ", "=", " ", 
  "\"\<extractMeasures[parsedGameData] returns a table where rows are \
subjects and columns are the 30 standard CFG measures. The output of this \
function includes a first row of labels for the columns.\>\""}]], "Input",
 CellChangeTimes->{{3.8224560824735355`*^9, 3.822456229704886*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"960a2eda-08db-4ad1-9561-35b946587a45"],

Cell[BoxData["\<\"extractMeasures[parsedGameData] returns a table where rows \
are subjects and columns are the 30 standard CFG measures. The output of this \
function includes a first row of labels for the columns.\"\>"], "Output",
 CellChangeTimes->{3.827941524889693*^9, 3.827941640352035*^9},
 CellLabel->"Out[3]=",ExpressionUUID->"11be5264-2032-44b0-b972-e22cb062d645"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"R", "::", "usage"}], " ", "=", " ", 
  "\"\<R is a dispatch of a mapping from every serial number to the grid \
coordinates of a shape.\>\""}]], "Input",
 CellChangeTimes->{{3.8208667193456926`*^9, 3.82086677031074*^9}, {
  3.8269425528252583`*^9, 3.826942562928217*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"8a2fd2d6-fc4a-4aa5-a1e1-38c04a9898af"],

Cell[BoxData["\<\"R is a dispatch of a mapping from every serial number to \
the grid coordinates of a shape.\"\>"], "Output",
 CellChangeTimes->{3.827941524939531*^9, 3.8279416404049225`*^9},
 CellLabel->"Out[4]=",ExpressionUUID->"545aa631-044d-4729-a73c-e7743fb1afd9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AllGallerySP", "::", "usage"}], " ", "=", " ", 
  "\"\<AllGallerySP is a dispatch of a mapping from each pair of serial \
numbers of shapes to the length of the shortest path between them. Accounts \
only for shapes ever saved to gallery.\>\""}]], "Input",
 CellChangeTimes->{{3.8208669854527407`*^9, 3.8208670690369234`*^9}, {
  3.822469253246604*^9, 3.822469253373215*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"286692c1-466b-4f9d-88d4-a1c19e982b07"],

Cell[BoxData["\<\"AllGallerySP is a dispatch of a mapping from each pair of \
serial numbers of shapes to the length of the shortest path between them. \
Accounts only for shapes ever saved to gallery.\"\>"], "Output",
 CellChangeTimes->{3.827941524955488*^9, 3.8279416404587784`*^9},
 CellLabel->"Out[5]=",ExpressionUUID->"48e61143-91fb-44f8-b237-ce0f2b99dbc9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"g", "::", "usage"}], " ", "=", " ", 
  "\"\<g is the graph of shapes.\>\""}]], "Input",
 CellChangeTimes->{{3.8214688892485905`*^9, 3.821468904286392*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"ffba4d92-4692-4858-a1f2-34104eba17ee"],

Cell[BoxData["\<\"g is the graph of shapes.\"\>"], "Output",
 CellChangeTimes->{3.8279415249684534`*^9, 3.8279416405016336`*^9},
 CellLabel->"Out[6]=",ExpressionUUID->"af2b3f2f-4ac8-46e9-9304-a87d06c9dbe3"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Begin the `Private context", "Section",ExpressionUUID->"288fe475-476e-4d19-a17e-cdbefef0a796"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}]], "Input",
 CellLabel->"In[7]:=",ExpressionUUID->"461da5bc-6749-4853-b15c-3d47d92d048e"],

Cell[BoxData["\<\"ParserLightUtils`Private`\"\>"], "Output",
 CellChangeTimes->{3.827941524985437*^9, 3.827941640545517*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"4cc39e13-f888-42c0-b811-59d6f7d7517f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Function definitions", "Subsection",ExpressionUUID->"503ceb67-6a6a-4d13-a487-9878c422a4f5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"coor2shape", "[", "x_", "]"}], ":=", 
  RowBox[{"ToString", "/@", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", "^", 
          RowBox[{"(", 
           RowBox[{"Reverse", "@", 
            RowBox[{"Range", "[", 
             RowBox[{"0", ",", "9"}], "]"}]}], ")"}]}], ".", "#"}], ")"}], 
       "&"}], "/@", 
      RowBox[{"Normal", "@", 
       RowBox[{"SparseArray", "[", 
        RowBox[{
         RowBox[{"Thread", "[", 
          RowBox[{"x", "\[Rule]", "1"}], "]"}], ",", "10"}], "]"}]}]}], ",", 
     "0"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.820866315046872*^9, 3.820866326612446*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"ebe0c3b0-5d2a-40f7-a790-5189c2ec9a47"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Parse", "[", "gameData_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"starttime", "=", 
         RowBox[{"DateObject", "@", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"#", ",", 
             RowBox[{"{", 
              RowBox[{"___", ",", "\"\<startsearch\>\"", ",", "___"}], 
              "}"}]}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "3"}], "]"}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"per", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{"#", ",", "\"\<startsearch\>\""}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", "1"}]}]}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"StringSplit", "[", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "5"}], "]"}], "]"}], ",", "\"\<,\>\""}], "]"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Check", "[", 
          RowBox[{
           RowBox[{"StringDelete", "[", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "11", ",", "\"\<userProvidedId\>\""}], "]"}],
               "]"}], ",", "\"\< \>\""}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "11", ",", "\"\<userId\>\""}], "]"}], "]"}]}], 
          "]"}], "//", "Quiet"}], ",", "\[IndentingNewLine]", "starttime", 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "@", "#"}], "==", "2"}], ",", "#", ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{";;", "3"}], "]"}], "]"}]}], "]"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Join", "@@", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"coor2shape", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "-", 
                    RowBox[{"Min", "/@", 
                    RowBox[{"(", "#", ")"}]}], "+", "1"}], ")"}], 
                    "\[Transpose]"}], "]"}], "&"}], "@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Reverse", "/@", "#"}], ")"}], "\[Transpose]"}], 
                    ")"}]}], "&"}], "@", 
                 RowBox[{"ToExpression", "[", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}], "/.", 
                   RowBox[{"x_String", "\[RuleDelayed]", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<{\>\""}], ",", 
                    RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<}\>\""}]}], "}"}]}], 
                    "]"}]}]}], "]"}]}], "}"}], ",", 
               RowBox[{
                RowBox[{"DateDifference", "[", 
                 RowBox[{"starttime", ",", 
                  RowBox[{"DateObject", "/@", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", "1"}], "]"}], "]"}]}], ",", 
                  "\"\<Second\>\""}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", "1"}], "]"}], "]"}]}], "}"}]}], "&"}], "/@", 
           RowBox[{"Split", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Prepend", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"Cases", "[", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{"per", ";;"}], "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"___", ",", 
                    RowBox[{
                    "\"\<movedblock\>\"", "|", 
                    "\"\<added shape to gallery\>\""}], ",", "___"}], "}"}]}],
                  "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", 
                  RowBox[{"{", 
                   RowBox[{"3", ",", "12", ",", "19", ",", "23"}], "}"}]}], 
                 "]"}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Cases", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"___", ",", "\"\<startsearch\>\"", ",", "___"}], 
                    "}"}]}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "3"}], "]"}], "]"}], ",", 
                 "\"\<movedblock\>\"", ",", 
                 "\"\<[[0,0],[1,0],[2,0],[4,0],[5,0],[6,0],[3,0],[7,0],[8,0],[\
9,0]]\>\"", ",", "\"\<\>\""}], "}"}]}], "]"}], ",", 
             RowBox[{
              RowBox[{"MatchQ", "[", 
               RowBox[{"#2", ",", 
                RowBox[{"{", 
                 RowBox[{
                 "___", ",", "\"\<added shape to gallery\>\"", ",", "___"}], 
                 "}"}]}], "]"}], "&"}]}], "]"}]}], ")"}]}], ",", 
        "\[IndentingNewLine]", "\"\<\>\""}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"coor2shape", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#", "-", 
                RowBox[{"Min", "/@", 
                 RowBox[{"(", "#", ")"}]}], "+", "1"}], ")"}], 
              "\[Transpose]"}], "]"}], "&"}], "@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Reverse", "/@", "#"}], ")"}], "\[Transpose]"}], 
            ")"}]}], "&"}], "/@", 
         RowBox[{"ToExpression", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{"#", ",", 
              RowBox[{"{", 
               RowBox[{"___", ",", "\"\<selected shape\>\"", ",", "___"}], 
               "}"}]}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "19"}], "]"}], "]"}], "/.", 
           RowBox[{"x_String", "\[RuleDelayed]", 
            RowBox[{"StringReplace", "[", 
             RowBox[{"x", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<{\>\""}], ",", 
                RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<}\>\""}]}], "}"}]}], 
             "]"}]}]}], "]"}]}], "*)"}], "}"}]}], "]"}], "&"}], "@", 
   "gameData"}]}]], "Input",
 CellChangeTimes->{{3.8208663350150185`*^9, 3.820866335534137*^9}, {
  3.82694058035877*^9, 3.8269405897633705`*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"3ceed97b-0ea4-40e2-a811-a3f56c0b3feb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ShapePlot5a", "[", 
   RowBox[{"s_", ",", 
    RowBox[{"OptionsPattern", "[", 
     RowBox[{"{", 
      RowBox[{"\"\<BackgroundColor\>\"", "\[Rule]", "Black"}], "}"}], "]"}]}],
    "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MatrixPlot", "[", 
     RowBox[{
      RowBox[{"ArrayPad", "[", 
       RowBox[{"#", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Ceiling", "[", 
             FractionBox[
              RowBox[{"12", "-", "#"}], "2"], "]"}], ",", 
            RowBox[{"Floor", "[", 
             FractionBox[
              RowBox[{"12", "-", "#"}], "2"], "]"}]}], "}"}], "&"}], "/@", 
         RowBox[{"Dimensions", "[", "#", "]"}]}]}], "]"}], ",", 
      RowBox[{"AspectRatio", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"FrameTicks", "\[Rule]", "False"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "100"}], ",", 
      RowBox[{"Frame", "\[Rule]", "False"}], ",", 
      RowBox[{"ColorRules", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0", "\[Rule]", " ", 
          RowBox[{"OptionValue", "[", "\"\<BackgroundColor\>\"", "]"}]}], ",", 
         RowBox[{"1", "\[Rule]", "Green"}]}], "}"}]}], ",", 
      RowBox[{"Mesh", "\[Rule]", "True"}], ",", 
      RowBox[{"MeshStyle", "\[Rule]", 
       RowBox[{"OptionValue", "[", "\"\<BackgroundColor\>\"", "]"}]}], ",", 
      RowBox[{"FrameStyle", "\[Rule]", 
       RowBox[{"Thickness", "[", ".2", "]"}]}]}], "]"}], "&"}], "@", 
   RowBox[{"Transpose", "[", 
    RowBox[{"DeleteCases", "[", 
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"IntegerDigits", "[", 
           RowBox[{"#1", ",", "2", ",", "10"}], "]"}], "&"}], ")"}], "/@", 
        RowBox[{"ToExpression", "[", "s", "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ".."}], "}"}]}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8208663430787797`*^9, 3.820866344397451*^9}, {
  3.8211699989752007`*^9, 3.821170101846757*^9}, {3.82147111312514*^9, 
  3.8214711225521374`*^9}, {3.8214712056001396`*^9, 3.8214712129771028`*^9}, {
  3.821471250531933*^9, 3.8214712538011956`*^9}, {3.821471827367964*^9, 
  3.8214718426931133`*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"b235e257-20bc-4e41-837d-495791ad8205"],

Cell[BoxData[
 RowBox[{
  RowBox[{"alledges", "=", 
   RowBox[{"ReadList", "[", "\"\<alledges.txt\>\"", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.820866347721816*^9, 3.820866349252609*^9}, {
  3.8211771653706045`*^9, 3.8211771676245794`*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"4112649f-ef53-4d5b-b257-4315229b114b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"allshapes", "=", 
   RowBox[{"ReadList", "[", "\"\<allshapes.txt\>\"", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.820866352890319*^9, 3.8208663532523766`*^9}, {
  3.821177168727631*^9, 3.8211771707671785`*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"acc02a58-db2f-4198-ae54-de8f9c636b88"],

Cell[BoxData[
 RowBox[{
  RowBox[{"r", "=", 
   RowBox[{"MapIndexed", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"#1", "\[Rule]", 
       RowBox[{"ToString", "[", 
        RowBox[{"#2", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "&"}], ",", 
     RowBox[{"Map", "[", 
      RowBox[{"coor2shape", ",", "allshapes"}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.820866357083011*^9, 3.820866357524414*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"2c46d604-43c4-4493-a55b-ad3f3bc1b6c3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"R", "=", 
   RowBox[{"Dispatch", "[", "r", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8208663611623173`*^9, 3.8208663614121647`*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"22bb935d-ac2a-49a3-8221-f92b23c1385a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"backr", "=", 
   RowBox[{"Dispatch", "[", 
    RowBox[{"Reverse", "/@", "r"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.820866365115452*^9, 3.820866365420394*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"59aad3ed-e70f-4fc0-bfec-b556327cb8ac"],

Cell[BoxData[
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{"Graph", "[", 
    RowBox[{
     RowBox[{"UndirectedEdge", "@@@", "alledges"}], "/.", "R"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8208663747619276`*^9, 3.820866376788821*^9}, 
   3.82117718552277*^9},
 CellLabel->"In[18]:=",ExpressionUUID->"26b04c74-ed83-4ebf-89b2-c29e221a74c9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"symrule", "=", 
   RowBox[{"Dispatch", "@", 
    RowBox[{"ReadList", "[", "\"\<symrule.txt\>\"", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8208663824745064`*^9, 3.8208663827805166`*^9}, {
  3.821177172210321*^9, 3.821177174167115*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"7db9db8a-fb66-4301-8ce9-25462620b799"],

Cell[BoxData[
 RowBox[{
  RowBox[{"calcOrigUnited", "[", "parsedSubjectData_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ReadList", "[", "\"\<Vanilla.txt\>\"", "]"}], ",", 
         "parsedSubjectData"}], "}"}]}], ",", "allShapesAndTimes", ",", 
      "galleryShapesAndTimes", ",", "galleryShapes"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"allShapesAndTimes", "=", 
      RowBox[{"Join", "@@", 
       RowBox[{"Join", "@@", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", ";;", ",", "3"}], "]"}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"galleryShapesAndTimes", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"allShapesAndTimes", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "#"}], "\[Equal]", "3"}], "&"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"galleryShapes", "=", 
      RowBox[{"galleryShapesAndTimes", "[", 
       RowBox[{"[", 
        RowBox[{";;", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Dispatch", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "/.", "R"}], ")"}], "\[Rule]", 
          RowBox[{"-", 
           RowBox[{"Log10", "[", 
            RowBox[{"N", "@", 
             FractionBox[
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], 
              RowBox[{"Total", "@", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]]}], "]"}]}]}], "]"}], "&"}], 
       "@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Tally", "@", "galleryShapes"}], "\[Transpose]"}], ")"}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.82086639417647*^9, 3.820866394814801*^9}, {
   3.8208673796792617`*^9, 3.8208673801404543`*^9}, {3.8211771751923485`*^9, 
   3.82117718941533*^9}, {3.8224018879454393`*^9, 3.8224019394517584`*^9}, {
   3.8224020376194563`*^9, 3.8224020438515882`*^9}, {3.8224537817740927`*^9, 
   3.8224537821876373`*^9}, {3.8224539050587983`*^9, 3.822453910548769*^9}, {
   3.822467866419418*^9, 3.8224678763942833`*^9}, {3.8224679085795736`*^9, 
   3.822467924143648*^9}, {3.8224684452360296`*^9, 3.822468473232685*^9}, {
   3.8224685583097477`*^9, 3.8224686126178503`*^9}, {3.8224686961670947`*^9, 
   3.8224687656811247`*^9}, {3.8224688654658384`*^9, 
   3.8224689252459946`*^9}, {3.822469023026062*^9, 3.8224690263180637`*^9}, 
   3.8224704481174965`*^9, {3.8269417569703417`*^9, 3.82694176903338*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"26cf06ce-8fb5-4de9-baab-bc6f741a9d09"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AllGallerySP", "=", 
  RowBox[{"Dispatch", "[", 
   RowBox[{"ReadList", "[", "\"\<utils/AllGallerySP.txt\>\"", "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8208673813197937`*^9, 3.8208673817649355`*^9}, {
  3.8224020585646687`*^9, 3.8224020591240916`*^9}, {3.8279419185775394`*^9, 
  3.827941958965543*^9}, {3.8279421812015114`*^9, 
  3.8279422080364494`*^9}},ExpressionUUID->"6a8e3d5e-4180-4dc2-9e5f-\
116d9a2366c8"],

Cell[BoxData[
 TagBox[
  TemplateBox[{RowBox[{
      StyleBox[
       TagBox["Dispatch", "SummaryHead"], "NonInterpretableSummary"], 
      StyleBox["[", "NonInterpretableSummary"], 
      DynamicModuleBox[{
       Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
       TemplateBox[{
         TemplateBox[{
           PaneSelectorBox[{False -> GridBox[{{
                 PaneBox[
                  ButtonBox[
                   DynamicBox[
                    FEPrivate`FrontEndResource[
                    "FEBitmaps", "SquarePlusIconMedium"]], 
                   ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                   None, Evaluator -> Automatic, Method -> "Preemptive"], 
                  Alignment -> {Center, Center}, ImageSize -> 
                  Dynamic[{
                    Automatic, 
                    3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
                 GraphicsBox[{
                   GrayLevel[0.5], 
                   
                   PolygonBox[{{0.25, 0.5}, {0.05, 0.35}, {0.15, 0.35}, {0.35,
                     0.5}, {0.15, 0.65}, {0.05, 0.65}}], 
                   
                   PolygonBox[{{0.4, 0.5}, {0.2, 0.35}, {0.35, 0.35}, {0.55, 
                    0.5}, {0.35, 0.65}, {0.2, 0.65}}], 
                   
                   PolygonBox[{{0.95, 0.5}, {0.55, 0.1}, {0.6, 0.35}, {0.4, 
                    0.35}, {0.6, 0.5}, {0.4, 0.65}, {0.6, 0.65}, {0.55, 
                    0.9}}]}, PlotRange -> {{-0.05, 1.05}, {-0.05, 1.05}}, 
                  Background -> GrayLevel[0.93], FrameStyle -> Directive[
                    Thickness[Tiny], 
                    GrayLevel[0.7]], Axes -> False, AspectRatio -> 1, 
                  ImageSize -> 
                  Dynamic[{
                    Automatic, 
                    3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}], Frame -> True, FrameTicks -> None, 
                  FrameStyle -> Directive[
                    Opacity[0.5], 
                    Thickness[Tiny], 
                    RGBColor[0.368417, 0.506779, 0.709798]]], 
                 GridBox[{{
                    RowBox[{
                    TagBox["\"Length: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["111022", "SummaryItem"]}]}}, 
                  GridBoxAlignment -> {
                   "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, 
                  AutoDelete -> False, 
                  GridBoxItemSize -> {
                   "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                  GridBoxSpacings -> {
                   "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
                  BaseStyle -> {
                   ShowStringCharacters -> False, NumberMarks -> False, 
                    PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
               GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
               GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               BaselinePosition -> {1, 1}], True -> GridBox[{{
                 PaneBox[
                  ButtonBox[
                   DynamicBox[
                    FEPrivate`FrontEndResource[
                    "FEBitmaps", "SquareMinusIconMedium"]], 
                   ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                   None, Evaluator -> Automatic, Method -> "Preemptive"], 
                  Alignment -> {Center, Center}, ImageSize -> 
                  Dynamic[{
                    Automatic, 
                    3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
                 GraphicsBox[{
                   GrayLevel[0.5], 
                   
                   PolygonBox[{{0.25, 0.5}, {0.05, 0.35}, {0.15, 0.35}, {0.35,
                     0.5}, {0.15, 0.65}, {0.05, 0.65}}], 
                   
                   PolygonBox[{{0.4, 0.5}, {0.2, 0.35}, {0.35, 0.35}, {0.55, 
                    0.5}, {0.35, 0.65}, {0.2, 0.65}}], 
                   
                   PolygonBox[{{0.95, 0.5}, {0.55, 0.1}, {0.6, 0.35}, {0.4, 
                    0.35}, {0.6, 0.5}, {0.4, 0.65}, {0.6, 0.65}, {0.55, 
                    0.9}}]}, PlotRange -> {{-0.05, 1.05}, {-0.05, 1.05}}, 
                  Background -> GrayLevel[0.93], FrameStyle -> Directive[
                    Thickness[Tiny], 
                    GrayLevel[0.7]], Axes -> False, AspectRatio -> 1, 
                  ImageSize -> 
                  Dynamic[{
                    Automatic, 
                    3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}], Frame -> True, FrameTicks -> None, 
                  FrameStyle -> Directive[
                    Opacity[0.5], 
                    Thickness[Tiny], 
                    RGBColor[0.368417, 0.506779, 0.709798]]], 
                 GridBox[{{
                    RowBox[{
                    TagBox["\"Length: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["111022", "SummaryItem"]}]}, {
                    RowBox[{
                    TagBox["\"Rules:\"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"\"", "SummaryItem"]}]}, {
                    TagBox[
                    TagBox[
                    GridBox[{{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", "0"}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}], "\[Rule]", "1"}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "3"}], "}"}], "\[Rule]", "1"}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "4"}], "}"}], "\[Rule]", "1"}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "5"}], "}"}], "\[Rule]", "1"}]}, {
                    ItemBox[
                    "\"\[VerticalEllipsis]\"", Alignment -> Center, 
                    StripOnInput -> False]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                    "Column"], "SummaryItem"]}}, 
                  GridBoxAlignment -> {
                   "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, 
                  AutoDelete -> False, 
                  GridBoxItemSize -> {
                   "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                  GridBoxSpacings -> {
                   "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
                  BaseStyle -> {
                   ShowStringCharacters -> False, NumberMarks -> False, 
                    PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
               GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
               GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               BaselinePosition -> {1, 1}]}, 
            Dynamic[Typeset`open$$], ImageSize -> Automatic]}, 
          "SummaryPanel"], 
         ButtonBox[
          DynamicBox[
           ToBoxes[
            If[
             
             Or[$VersionNumber < 11.2, CurrentValue["RunningEvaluator"] =!= 
              "Local"], 
             Style["This object cannot be used as input.", "SummaryEmbed"], 
             BoxForm`EmbedSummaryLabel[Dispatch, 22032192, 
              Dynamic[Typeset`embedState$$]]], StandardForm]], ButtonFunction :> 
          BoxForm`EmbedSummaryInterpretation[
           Dispatch, 
            10042232972052925465927693528463060478430291641371069876128, 
            EvaluationBox[], 
            Dynamic[Typeset`embedState$$], StandardForm], DefaultBaseStyle -> 
          "SummaryEmbedButton", BaseStyle -> {"DialogStyle"}, Enabled -> 
          Dynamic[
            
            And[$VersionNumber >= 11.2, CurrentValue["RunningEvaluator"] === 
             "Local", Typeset`embedState$$ === "Ready"]], Appearance -> 
          Inherited, Method -> Inherited, Evaluator -> Automatic]}, 
        "SummaryEmbedGrid"], DynamicModuleValues :> {}], 
      StyleBox["]", "NonInterpretableSummary"]}]},
   "CopyTag",
   DisplayFunction->(#& ),
   InterpretationFunction->("Dispatch[<111022>]"& )],
  False,
  BoxID -> 10042232972052925465927693528463060478430291641371069876128,
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{
  3.820867203747534*^9, 3.821169787810759*^9, 3.821170136998165*^9, {
   3.827941532456523*^9, 3.827941542508278*^9}, 3.827941647831278*^9, {
   3.8279417461256504`*^9, 3.8279417723776145`*^9}, 3.8279418876224966`*^9, {
   3.8279419228051558`*^9, 3.8279419601265364`*^9}},
 CellLabel->"Out[53]=",ExpressionUUID->"ccb837fd-6a33-4a1e-8c8b-b78a102bd299"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"findclusters2", "[", "game_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"AllGallerySP", "=", 
      RowBox[{"Dispatch", "[", 
       RowBox[{"ReadList", "[", "\"\<utils/AllGallerySP.txt\>\"", "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"#", ",", "1"}], "]"}], "&"}], "/@", 
      RowBox[{"Nest", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Split", "[", 
          RowBox[{"#", ",", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Flatten", "[", "#1", "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ">", 
             RowBox[{
              RowBox[{"Flatten", "[", "#2", "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "&"}]}], "]"}], "&"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Prepend", "[", 
              RowBox[{
               RowBox[{"Differences", "@", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", "0"}], "]"}], 
             RowBox[{"(*", "\[Delta]t", "*)"}], ",", "\[IndentingNewLine]", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], 
             RowBox[{"(*", 
              RowBox[{"accumulated", " ", "time"}], "*)"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Partition", "[", 
               RowBox[{
                RowBox[{"Prepend", "[", 
                 RowBox[{
                  RowBox[{"ToExpression", "@", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]}], ",", "1"}], "]"}], 
                ",", "2", ",", "1"}], "]"}], "/.", "AllGallerySP"}], 
             RowBox[{"(*", 
              RowBox[{"shortest", " ", "path"}], "*)"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], 
             RowBox[{"(*", 
              RowBox[{"real", " ", "path"}], "*)"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Accumulate", "@", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], 
             RowBox[{"(*", 
              RowBox[{"accumulated", " ", "steps"}], "*)"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}]}], 
            RowBox[{"(*", "shape", "*)"}], "}"}], "\[Transpose]"}], "&"}], 
         "@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Map", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"-", "1"}], ",", 
                   RowBox[{"-", "2"}]}], "]"}], "]"}], ",", 
                RowBox[{"Length", "[", "#", "]"}], ",", 
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], "}"}], 
              "&"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Select", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Split", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"game", "[", 
                   RowBox[{"[", 
                    RowBox[{"-", "2"}], "]"}], "]"}], "/.", "R"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", "#", "]"}], "=!=", "3"}], "&"}]}], 
                "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "]"}], "\[Equal]", 
                 "3"}], "&"}]}], "]"}]}], "\[IndentingNewLine]", "]"}], 
           "\[Transpose]"}], ")"}]}], ",", "2"}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.8145132197034883`*^9, 3.81451322271228*^9}, {
   3.8145133781809626`*^9, 3.814513387897145*^9}, {3.814513418611484*^9, 
   3.8145134228463235`*^9}, 3.822455295486359*^9, {3.822455617802766*^9, 
   3.8224556440416355`*^9}, 3.82246868545601*^9, {3.8224690552170887`*^9, 
   3.822469070424074*^9}, {3.827942361333762*^9, 
   3.827942362541597*^9}},ExpressionUUID->"dbfacdd2-3a5d-4894-b4f2-\
95864a65b55b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"info", "[", "ParsedSubjectData_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ClusteredParsedSubjectData", ",", "Orig", ",", "GalleryCount", ",", 
       "GC", ",", "SubjectClusters", ",", "crule", ",", "crulereverse", ",", 
       "scedges", ",", "SCG", ",", "CC", ",", "VLs", ",", "GraphCommunities", 
       ",", "OrigUnited"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ClusteredParsedSubjectData", "=", 
       RowBox[{"findclusters2", "/@", "ParsedSubjectData"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Orig", "=", 
       RowBox[{"Dispatch", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "/.", "R"}], ")"}], "\[Rule]", 
            RowBox[{"-", 
             RowBox[{"Log10", "[", 
              RowBox[{"N", "@", 
               FractionBox[
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], 
                RowBox[{"Total", "@", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}]]}], "]"}]}]}], "]"}], 
          "&"}], "@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Tally", "[", 
            RowBox[{"Cases", "[", 
             RowBox[{"ParsedSubjectData", ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x_List", ",", "y_Real", ",", "z_Real"}], "}"}], 
               "\[RuleDelayed]", "x"}], ",", "\[Infinity]"}], "]"}], "]"}], 
           "\[Transpose]"}], ")"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"OrigUnited", "=", 
       RowBox[{"calcOrigUnited", "[", "ParsedSubjectData", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"GalleryCount", "=", 
       RowBox[{"Dispatch", "[", 
        RowBox[{"Rule", "@@@", 
         RowBox[{"Tally", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{"DeleteDuplicates", "/@", 
            RowBox[{"Flatten", "/@", 
             RowBox[{"ClusteredParsedSubjectData", "[", 
              RowBox[{"[", 
               RowBox[{";;", ",", ";;", ",", ";;", ",", 
                RowBox[{"-", "1"}]}], "]"}], "]"}]}]}], "]"}], "]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"GC", "=", 
       RowBox[{
        RowBox[{"ConnectedComponents", "[", 
         RowBox[{"Graph", "[", 
          RowBox[{
           RowBox[{"UndirectedEdge", "@@@", 
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{"Subsets", "[", 
               RowBox[{
                RowBox[{"Select", "[", 
                 RowBox[{
                  RowBox[{"Union", "@@", 
                   RowBox[{"ClusteredParsedSubjectData", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", ";;", ",", ";;", ",", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "@", "#"}], ">", "2"}], "&"}]}], "]"}], 
                ",", 
                RowBox[{"{", "2", "}"}]}], "]"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"Intersection", "@@", "#"}], "]"}], ">", "1"}], 
               "&"}]}], "]"}]}], ",", 
           RowBox[{"GraphLayout", "\[Rule]", "None"}]}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"SubjectClusters", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"Union", "/@", 
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{";;", ",", ";;", ",", 
               RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "@", "#"}], ">", "2"}], "&"}]}], "]"}], "&"}], 
        "/@", "ClusteredParsedSubjectData"}]}], ";", 
      RowBox[{"crule", "=", 
       RowBox[{"Dispatch", "[", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Thread", "[", 
            RowBox[{"#", "\[Rule]", 
             RowBox[{"Range", "@", 
              RowBox[{"Length", "@", "#"}]}]}], "]"}], "&"}], "@", 
          RowBox[{"(", 
           RowBox[{"Join", "@@", "SubjectClusters"}], ")"}]}], ")"}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"crulereverse", "=", 
       RowBox[{"Dispatch", "[", 
        RowBox[{"Reverse", "/@", 
         RowBox[{"Normal", "@", "crule"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"scedges", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"UndirectedEdge", "@@@", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Subsets", "[", 
             RowBox[{
              RowBox[{"Join", "@@", "SubjectClusters"}], ",", 
              RowBox[{"{", "2", "}"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Intersection", "@@", "#"}], "]"}], "\[GreaterEqual]", 
              "3"}], "&"}]}], "]"}]}], "/.", "crule"}], ")"}]}], ";", "\n", 
      "\[IndentingNewLine]", 
      RowBox[{"SCG", "=", 
       RowBox[{"Graph", "[", "scedges", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"CC", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Subgraph", "[", 
          RowBox[{"#", ",", 
           RowBox[{
            RowBox[{"ConnectedComponents", "[", "#", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}], "@", "SCG"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"VLs", "=", 
       RowBox[{"VertexList", "[", "CC", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"GraphCommunities", "=", 
       RowBox[{"FindGraphCommunities", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Subgraph", "[", 
             RowBox[{"#", ",", 
              RowBox[{
               RowBox[{"ConnectedComponents", "[", "#", "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}], "@", "SCG"}], 
          ")"}], ",", 
         RowBox[{"Method", "\[Rule]", "\"\<Modularity\>\""}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Flatten", "/@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"3", ",", 
                  RowBox[{"-", "1"}], ",", 
                  RowBox[{"-", "1"}]}], "]"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Length", "@", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
               FractionBox[
                RowBox[{"Length", "@", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], 
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"3", ",", 
                   RowBox[{"-", "1"}], ",", 
                   RowBox[{"-", "1"}]}], "]"}], "]"}]], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Count", "[", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], ",", 
                 RowBox[{"_", "?", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", "#"}], "\[Equal]", "3"}], "&"}], 
                   ")"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"N", "@", 
                  FractionBox[
                   RowBox[{"Length", "@", 
                    RowBox[{"DeleteDuplicates", "[", "#", "]"}]}], 
                   RowBox[{"Length", "@", 
                    RowBox[{"Split", "[", "#", "]"}]}]]}], "&"}], "@", 
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"3", ",", ";;", ",", "1"}], "]"}], "]"}]}]}], 
              RowBox[{"(*", 
               RowBox[{",", "\[IndentingNewLine]", 
                RowBox[{"Mean", "[", 
                 RowBox[{"Cases", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"HoldPattern", "[", 
                    RowBox[{"SparseArray", "[", "__", "]"}], "]"}]}], "]"}], "/.",
                     "R"}], "/.", "Orig"}], ",", "_Real"}], "]"}], "]"}]}], 
               "*)"}], 
              RowBox[{"(*", 
               RowBox[{",", 
                RowBox[{"Mean", "[", 
                 RowBox[{"Cases", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"HoldPattern", "[", 
                    RowBox[{"SparseArray", "[", "__", "]"}], "]"}]}], "]"}], "/.",
                     "R"}], "/.", "OrigUnited"}], ",", "_Real"}], "]"}], 
                 "]"}]}], "*)"}], "}"}], "&"}], "/@", "ParsedSubjectData"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"N", "@", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Count", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", "#"}], ">", "2"}], "&"}], 
                    ")"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"1", "-", 
                   FractionBox[
                    RowBox[{"Length", "@", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"Select", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", "#"}], ">", "2"}], "&"}]}], 
                    "]"}]}]}], 
                    RowBox[{"Length", "[", 
                    RowBox[{"Flatten", "@", "#"}], "]"}]]}], "&"}], "@", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", 
                   RowBox[{";;", ",", ";;", ",", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  FractionBox[
                   RowBox[{"Total", "@", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"Select", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", "#"}], "<", "3"}], "&"}]}], 
                    "]"}]}]}], 
                   RowBox[{"Total", "@", 
                    RowBox[{"Flatten", "@", "#"}]}]], "&"}], "@", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", 
                   RowBox[{";;", ",", ";;", ",", "1"}], "]"}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"#", ",", 
                    FractionBox[
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]]}], "}"}], "&"}], "@", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Median", "@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    FractionBox[
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]], "&"}], "/@", 
                    RowBox[{"(", 
                    RowBox[{"Join", "@@", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Select", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", "#"}], "<=", "2"}], "&"}]}], "]"}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], ",", "\[Infinity]"}], 
                    "]"}], ",", 
                    RowBox[{"{", "}"}]}], "]"}]}], ")"}]}], ")"}]}], "&"}], 
                    "@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", ";;", ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "4"}], "}"}]}], "]"}], "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Median", "@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    FractionBox[
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]], "&"}], "/@", 
                    RowBox[{"(", 
                    RowBox[{"Join", "@@", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Select", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", "#"}], ">", "2"}], "&"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], ",", "\[Infinity]"}], 
                    "]"}], ",", 
                    RowBox[{"{", "}"}]}], "]"}]}], ")"}]}], ")"}]}], "&"}], 
                    "@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", ";;", ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "4"}], "}"}]}], "]"}], "]"}]}]}], 
                  "}"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"Median", "/@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Total", "/@", 
                    RowBox[{
                    RowBox[{"Split", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", "#1"}], "==", "1"}], "&"}]}], 
                    "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", ";;", ",", "1"}], "]"}], "]"}]}], ",", 
                    RowBox[{"Total", "/@", 
                    RowBox[{
                    RowBox[{"Select", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", "#"}], ">", "2"}], "&"}]}], "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", 
                    RowBox[{"2", ";;"}]}], "]"}], "]"}]}]}], "}"}], "&"}], 
                   "@", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", ";;", ",", "4"}], "]"}], "]"}]}], 
                  ")"}]}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Mean", "@", 
                   RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", "#", "]"}], ",", "_Real"}], 
                    "]"}]}], "&"}], "/@", 
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    FractionBox[
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]], "&"}], ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Split", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", "#1"}], "==", "1"}], "&"}]}], 
                    "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", ";;", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"Select", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", "#"}], ">", "2"}], "&"}]}], "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", 
                    RowBox[{"2", ";;"}]}], "]"}], "]"}]}], "}"}], "&"}], "@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", ";;", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "4"}], "}"}]}], "]"}], "]"}]}], ",", 
                   RowBox[{"{", "3", "}"}]}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Mean", "@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Flatten", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", ";;", ",", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}], "]"}], "/.", "Orig"}],
                   ")"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"Mean", "@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Flatten", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", ";;", ",", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}], "]"}], "/.", 
                   "OrigUnited"}], ")"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Mean", "/@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"Split", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", "#1"}], "==", "1"}], "&"}]}], 
                    "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", ";;", ",", "1"}], "]"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"Select", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", "#"}], ">", "1"}], "&"}]}], "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", 
                    RowBox[{"2", ";;"}]}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"Select", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", "#"}], ">", "1"}], "&"}]}], "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}], 
                    "&"}], "@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", ";;", ",", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}]}], "/.", "Orig"}], 
                    ")"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"Mean", "/@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"Split", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", "#1"}], "==", "1"}], "&"}]}], 
                    "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", ";;", ",", "1"}], "]"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"Select", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", "#"}], ">", "1"}], "&"}]}], "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", 
                    RowBox[{"2", ";;"}]}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"Select", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", "#"}], ">", "1"}], "&"}]}], "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}], 
                    "&"}], "@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", ";;", ",", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}]}], "/.", 
                    "OrigUnited"}], ")"}]}]}], "}"}], "\[Transpose]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"N", "@", 
                    FractionBox[
                    RowBox[{"Count", "[", 
                    RowBox[{"#", ",", "1"}], "]"}], 
                    RowBox[{"Length", "@", "#"}]]}], "&"}], "@", 
                   RowBox[{"(", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"DeleteDuplicates", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", ";;", ",", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}], "]"}], "]"}], "/.", 
                    "GalleryCount"}], ")"}], ")"}]}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"N", "@", 
                    FractionBox[
                    RowBox[{"Count", "[", 
                    RowBox[{"#", ",", "1"}], "]"}], 
                    RowBox[{"Length", "@", "#"}]]}], "&"}], "@", 
                   RowBox[{"(", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"DeleteDuplicates", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"Split", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", "#1"}], "==", "1"}], "&"}]}], 
                    "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", ";;", ",", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}], "]"}], "]"}], "/.", 
                    "GalleryCount"}], ")"}], ")"}]}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"N", "@", 
                    FractionBox[
                    RowBox[{"Count", "[", 
                    RowBox[{"#", ",", "1"}], "]"}], 
                    RowBox[{"Length", "@", "#"}]]}], "&"}], "@", 
                   RowBox[{"(", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"DeleteDuplicates", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"Select", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", "#"}], ">", "1"}], "&"}]}], "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", 
                    RowBox[{"2", ";;"}], ",", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}], "]"}], "]"}], "/.", 
                    "GalleryCount"}], ")"}], ")"}]}]}], "}"}]}], "}"}]}], 
             "&"}], "/@", "ClusteredParsedSubjectData"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"Count", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", "#"}], ">", "2"}], "&"}]}], "]"}], 
                   "[", 
                   RowBox[{"[", 
                    RowBox[{";;", ",", "1"}], "]"}], "]"}], ",", 
                  RowBox[{"Alternatives", "@@", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ","}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"N", "@", 
               FractionBox[
                RowBox[{"Count", "[", 
                 RowBox[{"GC", ",", 
                  RowBox[{"Alternatives", "@@", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"Length", "@", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]]}], "}"}], 
             "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"ParsedSubjectData", "[", 
                  RowBox[{"[", 
                   RowBox[{";;", ",", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}], "/.", "R"}], ",", 
                RowBox[{"ClusteredParsedSubjectData", "[", 
                 RowBox[{"[", 
                  RowBox[{";;", ",", ";;", ",", ";;", ",", 
                   RowBox[{"-", "1"}]}], "]"}], "]"}]}], "}"}], 
              "\[Transpose]"}], ")"}]}], ",", 
           FractionBox[
            RowBox[{"(", 
             RowBox[{"Max", "/@", 
              RowBox[{"Differences", "/@", 
               RowBox[{"(", 
                RowBox[{"ParsedSubjectData", "[", 
                 RowBox[{"[", 
                  RowBox[{";;", ",", "3", ",", 
                   RowBox[{"4", ";;", 
                    RowBox[{"-", "4"}]}], ",", "2"}], "]"}], "]"}], ")"}]}]}],
              ")"}], "60."]}], "}"}], "\[Transpose]"}], ")"}]}]}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.740150251754161*^9, 3.7401502896099987`*^9}, {
   3.740150350479192*^9, 3.7401504084074717`*^9}, {3.740150449444737*^9, 
   3.740150476173592*^9}, {3.7401505633291397`*^9, 3.7401506163798237`*^9}, {
   3.7401507055309343`*^9, 3.740150744565473*^9}, {3.740150778782336*^9, 
   3.7401509119263763`*^9}, 3.740151012885934*^9, 3.7401513323643*^9, {
   3.740151602249132*^9, 3.7401516240586987`*^9}, {3.7401518781758823`*^9, 
   3.740151885595405*^9}, {3.740151989853036*^9, 3.740152001183034*^9}, 
   3.740152082781253*^9, {3.740152126065936*^9, 3.740152150173667*^9}, 
   3.740152257015005*^9, {3.740152295309062*^9, 3.7401523222469397`*^9}, 
   3.740152352554742*^9, {3.7401523961208553`*^9, 3.740152495961317*^9}, {
   3.74015252946316*^9, 3.740152666986629*^9}, {3.740152742936636*^9, 
   3.740152760554007*^9}, {3.740152793138145*^9, 3.740152795343314*^9}, {
   3.740152831232191*^9, 3.740152839177724*^9}, {3.740152890758*^9, 
   3.740152950558079*^9}, {3.7401529880225773`*^9, 3.740153035834631*^9}, {
   3.740153150035261*^9, 3.740153153422612*^9}, {3.740153200184428*^9, 
   3.740153334610805*^9}, {3.740153380932014*^9, 3.7401534256924477`*^9}, {
   3.740153541958934*^9, 3.7401535705631943`*^9}, {3.7401536148440866`*^9, 
   3.740153633872842*^9}, {3.74015392964839*^9, 3.740153932415358*^9}, {
   3.7402364033199987`*^9, 3.740236414847412*^9}, 3.740236813222775*^9, {
   3.7402370353874903`*^9, 3.740237040053376*^9}, {3.740238839497509*^9, 
   3.740238907770396*^9}, {3.740239185154676*^9, 3.740239206380002*^9}, {
   3.740283021235319*^9, 3.7402830676003428`*^9}, 3.7402834257561607`*^9, {
   3.741229982036346*^9, 3.741230004873163*^9}, {3.7430482325857697`*^9, 
   3.743048259924529*^9}, {3.7430482978157177`*^9, 3.743048417820148*^9}, 
   3.74304846663931*^9, 3.743049837678247*^9, 3.743050218787685*^9, {
   3.743050930010887*^9, 3.743050955370428*^9}, 3.743051272406526*^9, {
   3.743051316113804*^9, 3.7430513339284763`*^9}, 3.7430514229180393`*^9, 
   3.743051483561129*^9, 3.765401661162896*^9, 3.765402348286867*^9, 
   3.765402378420426*^9, {3.7654024191332407`*^9, 3.765402461753317*^9}, 
   3.7654027126023397`*^9, {3.7660296134405727`*^9, 3.766029621828363*^9}, 
   3.7660297486026154`*^9, {3.7660298097157516`*^9, 3.766029853052607*^9}, 
   3.76602988651466*^9, {3.766029917080722*^9, 3.766029930365841*^9}, {
   3.766029993186056*^9, 3.7660300204139957`*^9}, {3.76603005494909*^9, 
   3.7660300840652514`*^9}, 3.766030137221609*^9, 3.766030191567101*^9, 
   3.770569300542122*^9, {3.7720121169902687`*^9, 3.772012123810988*^9}, 
   3.772084378669426*^9, 3.772084427107389*^9, 3.772084614238806*^9, {
   3.772086671401691*^9, 3.7720866865388308`*^9}, 3.775147526098835*^9, {
   3.775191782554983*^9, 3.7751918035003567`*^9}, 3.775191903895084*^9, {
   3.7751959138546352`*^9, 3.775195921110549*^9}, {3.775196356538438*^9, 
   3.775196359373287*^9}, {3.778729479632408*^9, 3.778729488111067*^9}, {
   3.77872956752678*^9, 3.7787296179565372`*^9}, {3.778729690168873*^9, 
   3.778729717928719*^9}, {3.778729751341593*^9, 3.7787297554308443`*^9}, {
   3.789018457379846*^9, 3.7890184763409595`*^9}, {3.7890185071277466`*^9, 
   3.7890185160020823`*^9}, {3.789018735993512*^9, 3.7890187402433147`*^9}, 
   3.814516133364398*^9, {3.8224692777980347`*^9, 3.8224693929999256`*^9}, {
   3.8224694430573215`*^9, 3.8224694528733683`*^9}, {3.822470369775875*^9, 
   3.822470371663829*^9}, {3.822470428369276*^9, 3.8224704841611648`*^9}, {
   3.82247055582264*^9, 3.822470562852882*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"f246e390-8b71-4d46-8b1b-c0e3b97547b7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"extractMeasures", "[", "ParsedSubjecData_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"measures", ",", " ", "measuresFromData"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"measures", "=", 
      RowBox[{"{", 
       RowBox[{
       "\"\<ID\>\"", ",", " ", "\"\<Date/Time\>\"", ",", 
        "\"\<Total \\nPlay \\nTime\>\"", ",", "\"\<Total \\n# \\nmoves\>\"", 
        ",", "\"\<Average \\nSpeed\>\"", ",", "\"\<galleries\\n#\>\"", ",", 
        "\"\<self \\navoidance\>\"", ",", 
        RowBox[{"(*", 
         RowBox[{"\"\<Uniqueness of rated shapes\>\"", ","}], "*)"}], 
        RowBox[{"(*", 
         RowBox[{"\"\<Uniqueness of rated shapes (united)\>\"", ","}], 
         "*)"}], "\"\<clusters\\n#\>\"", ",", "\"\<% shapes \\nin exp\>\"", 
        ",", "\"\<% time \\nin exp\>\"", ",", "\"\<exp \\noptimality\>\"", 
        ",", "\"\<scav \\noptimality\>\"", ",", "\"\<optimality\\nratio\>\"", 
        ",", "\"\<median # steps \\nbetween shapes \\nin exp\>\"", ",", 
        "\"\<median # steps \\nbetween shapes \\nin scav\>\"", ",", 
        "\"\<exp\\nspeed\>\"", ",", "\"\<scav\\nspeed\>\"", ",", 
        "\"\<Orig\>\"", ",", "\"\<Orig (united)\>\"", ",", 
        "\"\<Orig \\nexp\>\"", ",", "\"\<Orig exp (united)\>\"", ",", 
        "\"\<Orig \\nscav\>\"", ",", "\"\<Orig scav (united)\>\"", ",", 
        "\"\<Orig \\ntrans\>\"", ",", "\"\<Orig trans (united)\>\"", ",", 
        "\"\<Unique \\nShapes\>\"", ",", "\"\<Unique \\nShapes exp\>\"", ",", 
        "\"\<Unique \\nShapes scav\>\"", ",", 
        RowBox[{"(*", 
         RowBox[{"\"\<trans rated\>\"", ","}], "*)"}], 
        "\"\<# clusters \\nin GC\>\"", ",", "\"\<% clusters \\nin GC\>\"", 
        ",", "\"\<max \[CapitalDelta]t \\n(min)\>\""}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"measuresFromData", "=", 
      RowBox[{
       RowBox[{"info", "[", "ParsedSubjecData", "]"}], "//", "Quiet"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Prepend", "[", 
      RowBox[{"measuresFromData", ",", "measures"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.8224559156510277`*^9, 3.822456034450884*^9}, {
  3.8224711327801695`*^9, 3.8224711542667437`*^9}, {3.824465941685353*^9, 
  3.8244659418848467`*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"e6396164-c267-46f3-b352-3c1a90491858"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["End the `Private context", "Section",ExpressionUUID->"861d951b-8a57-48a8-a712-686cf82fba21"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"End", "[", "]"}]], "Input",
 CellLabel->"In[26]:=",ExpressionUUID->"92438652-4807-4b62-b7c2-1b6ee8e0ac69"],

Cell[BoxData["\<\"ParserLightUtils`Private`\"\>"], "Output",
 CellChangeTimes->{3.8279415326021013`*^9, 3.827941648061632*^9},
 CellLabel->"Out[26]=",ExpressionUUID->"892c01b9-6f0d-4b30-b7d6-30cd8766568b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["End the package context", "Section",ExpressionUUID->"c5861181-50a2-4ebe-be5f-a12ad1ebf1d3"],

Cell[BoxData[
 RowBox[{"EndPackage", "[", "]"}]], "Input",
 CellLabel->"In[27]:=",ExpressionUUID->"ef760e39-5e7c-4b17-b584-7bf7cbe0870d"]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{1536, 781},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[StyleDefinitions -> "Default.nb"]], 
   Cell[
    StyleData["Code"], PageWidth -> WindowWidth, AutoIndent -> Automatic, 
    AutoSpacing -> True, LineBreakWithin -> Automatic, LineIndent -> 1, 
    LinebreakAdjustments -> {0.85, 2, 10, 0, 1}], 
   Cell[
    StyleData["Input"], InitializationCell -> True]}, Visible -> False, 
  FrontEndVersion -> "12.0 for Microsoft Windows (64-bit) (April 8, 2019)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 192, 2, 96, "Title",ExpressionUUID->"d28b36c3-0018-4f61-a12b-27c9218b0216"],
Cell[CellGroupData[{
Cell[797, 28, 91, 0, 67, "Section",ExpressionUUID->"86fcb346-a88e-466f-8d41-c8860af1f69e"],
Cell[CellGroupData[{
Cell[913, 32, 234, 3, 44, "Input",ExpressionUUID->"35112834-79e8-49f1-a76a-dfe10e8c9f1d"],
Cell[1150, 37, 228, 3, 32, "Output",ExpressionUUID->"a6bc6ff8-2a05-49e7-aea8-cfee39233abe"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1415, 45, 116, 0, 53, "Subsection",ExpressionUUID->"219ca509-2316-4f05-95b7-a14d7537bd79"],
Cell[CellGroupData[{
Cell[1556, 49, 407, 7, 44, "Input",ExpressionUUID->"af686d94-e4e4-43ac-8b55-76c8fb167801"],
Cell[1966, 58, 290, 3, 32, "Output",ExpressionUUID->"b887b837-fc8c-4a0d-a329-8c647fcd0863"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2293, 66, 454, 7, 83, "Input",ExpressionUUID->"960a2eda-08db-4ad1-9561-35b946587a45"],
Cell[2750, 75, 374, 4, 32, "Output",ExpressionUUID->"11be5264-2032-44b0-b972-e22cb062d645"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3161, 84, 384, 7, 44, "Input",ExpressionUUID->"8a2fd2d6-fc4a-4aa5-a1e1-38c04a9898af"],
Cell[3548, 93, 270, 3, 32, "Output",ExpressionUUID->"545aa631-044d-4729-a73c-e7743fb1afd9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3855, 101, 488, 8, 64, "Input",ExpressionUUID->"286692c1-466b-4f9d-88d4-a1c19e982b07"],
Cell[4346, 111, 362, 4, 32, "Output",ExpressionUUID->"48e61143-91fb-44f8-b237-ce0f2b99dbc9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4745, 120, 268, 5, 44, "Input",ExpressionUUID->"ffba4d92-4692-4858-a1f2-34104eba17ee"],
Cell[5016, 127, 206, 2, 32, "Output",ExpressionUUID->"af2b3f2f-4ac8-46e9-9304-a87d06c9dbe3"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[5283, 136, 100, 0, 67, "Section",ExpressionUUID->"288fe475-476e-4d19-a17e-cdbefef0a796"],
Cell[CellGroupData[{
Cell[5408, 140, 152, 2, 44, "Input",ExpressionUUID->"461da5bc-6749-4853-b15c-3d47d92d048e"],
Cell[5563, 144, 202, 2, 32, "Output",ExpressionUUID->"4cc39e13-f888-42c0-b811-59d6f7d7517f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5802, 151, 97, 0, 53, "Subsection",ExpressionUUID->"503ceb67-6a6a-4d13-a487-9878c422a4f5"],
Cell[5902, 153, 805, 23, 44, "Input",ExpressionUUID->"ebe0c3b0-5d2a-40f7-a790-5189c2ec9a47"],
Cell[6710, 178, 7361, 186, 312, "Input",ExpressionUUID->"3ceed97b-0ea4-40e2-a811-a3f56c0b3feb"],
Cell[14074, 366, 2368, 57, 130, "Input",ExpressionUUID->"b235e257-20bc-4e41-837d-495791ad8205"],
Cell[16445, 425, 327, 6, 44, "Input",ExpressionUUID->"4112649f-ef53-4d5b-b257-4315229b114b"],
Cell[16775, 433, 329, 6, 44, "Input",ExpressionUUID->"acc02a58-db2f-4198-ae54-de8f9c636b88"],
Cell[17107, 441, 515, 14, 44, "Input",ExpressionUUID->"2c46d604-43c4-4493-a55b-ad3f3bc1b6c3"],
Cell[17625, 457, 252, 5, 44, "Input",ExpressionUUID->"22bb935d-ac2a-49a3-8221-f92b23c1385a"],
Cell[17880, 464, 284, 6, 44, "Input",ExpressionUUID->"59aad3ed-e70f-4fc0-bfec-b556327cb8ac"],
Cell[18167, 472, 349, 9, 44, "Input",ExpressionUUID->"26b04c74-ed83-4ebf-89b2-c29e221a74c9"],
Cell[18519, 483, 357, 7, 44, "Input",ExpressionUUID->"7db9db8a-fb66-4301-8ce9-25462620b799"],
Cell[18879, 492, 2868, 67, 182, "Input",ExpressionUUID->"26cf06ce-8fb5-4de9-baab-bc6f741a9d09"],
Cell[CellGroupData[{
Cell[21772, 563, 448, 9, 44, "Input",ExpressionUUID->"6a8e3d5e-4180-4dc2-9e5f-116d9a2366c8"],
Cell[22223, 574, 9233, 189, 100, "Output",ExpressionUUID->"ccb837fd-6a33-4a1e-8c8b-b78a102bd299"]
}, Open  ]],
Cell[31471, 766, 4795, 118, 330, "Input",ExpressionUUID->"dbfacdd2-3a5d-4894-b4f2-95864a65b55b"],
Cell[36269, 886, 32105, 744, 1276, "Input",ExpressionUUID->"f246e390-8b71-4d46-8b1b-c0e3b97547b7"],
Cell[68377, 1632, 2425, 47, 197, "Input",ExpressionUUID->"e6396164-c267-46f3-b352-3c1a90491858"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[70851, 1685, 98, 0, 67, "Section",ExpressionUUID->"861d951b-8a57-48a8-a712-686cf82fba21"],
Cell[CellGroupData[{
Cell[70974, 1689, 130, 2, 44, "Input",ExpressionUUID->"92438652-4807-4b62-b7c2-1b6ee8e0ac69"],
Cell[71107, 1693, 205, 2, 32, "Output",ExpressionUUID->"892c01b9-6f0d-4b30-b7d6-30cd8766568b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[71361, 1701, 97, 0, 67, "Section",ExpressionUUID->"c5861181-50a2-4ebe-be5f-a12ad1ebf1d3"],
Cell[71461, 1703, 137, 2, 44, "Input",ExpressionUUID->"ef760e39-5e7c-4b17-b584-7bf7cbe0870d"]
}, Open  ]]
}, Open  ]]
}
]
*)

